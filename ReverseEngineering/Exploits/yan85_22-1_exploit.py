from pwn import *

yan85 = process('/challenge/babyrev-level-22-1')
output = yan85.recvuntil('yancode:')
garbageA = b'A'*80
garbageB = b'B'*80
print(output)
push = bytes.fromhex('000840') # stk 0 a ie; push register a

yancode = bytes.fromhex('082f08') #imm a 01 
yancode += push
yancode += bytes.fromhex('086608') #imm a 01 
yancode += push
yancode += bytes.fromhex('086c08') #imm a 01 
yancode += push
yancode += bytes.fromhex('086108') #imm a 01 
yancode += push
yancode += bytes.fromhex('086708')  # imm c 06
yancode += push
yancode += bytes.fromhex('080108') # imm a 01
yancode += bytes.fromhex('010880') # open

yancode += bytes.fromhex('01ff08') # imm c ff
yancode += bytes.fromhex('020880') # read

yancode += bytes.fromhex('080108') # imm a 01
yancode += bytes.fromhex('200880') # write

yancode += bytes.fromhex('100880')
yan85.send(yancode)
print("Yancode sent..")

garbage = b"A"*1000
for i in range(100):
    print(yan85.recvline())

